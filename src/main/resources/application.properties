# ==============================================================================
# APPLICATION CONFIGURATION
# ==============================================================================
spring.application.name=app
server.port=${SERVER_PORT:3000}

# Tolerar doble slash en URLs (workaround para bug de frontend)
server.tomcat.relaxed-path-chars=|,{,}
server.tomcat.relaxed-query-chars=|,{,}
spring.mvc.servlet.path=/
spring.mvc.pathmatch.matching-strategy=ant_path_matcher

# ==============================================================================
# FRONTEND & CORS
# ==============================================================================
app.frontendUrl=${APP_FRONTEND_URL:http://localhost:4200}
app.frontend.url=${APP_FRONTEND_URL:http://localhost:4200}
cors.allowed-origins=${CORS_ALLOWED_ORIGINS:http://localhost:4200,ionic://localhost,capacitor://localhost}

# ==============================================================================
# EMAIL / SMTP CONFIGURATION
# ==============================================================================
spring.mail.host=${MAIL_HOST:smtp.gmail.com}
spring.mail.port=${MAIL_PORT:587}
spring.mail.username=${MAIL_USERNAME:}
spring.mail.password=${MAIL_PASSWORD:}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000

# ==============================================================================
# DATABASE CONFIGURATION
# ==============================================================================
spring.datasource.url=${JDBC_DATABASE_URL:jdbc:postgresql://localhost:5432/sl_db}
spring.datasource.username=${JDBC_DATABASE_USERNAME:postgres}
spring.datasource.password=${JDBC_DATABASE_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA configurations
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=${JPA_SHOW_SQL:false}
spring.jpa.properties.hibernate.format_sql=true

# ==============================================================================
# FILE UPLOAD
# ==============================================================================
spring.servlet.multipart.max-file-size=200MB
spring.servlet.multipart.max-request-size=200MB

# Server timeout para soportar procesamiento s√≠ncrono de medias
server.tomcat.connection-timeout=300000
spring.mvc.async.request-timeout=300000

# ==============================================================================
# ENCODING
# ==============================================================================
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true

# ==============================================================================
# STRIPE CONFIGURATION
# ==============================================================================
stripe.secret=${STRIPE_SECRET_KEY}
stripe.priceId=${STRIPE_PRICE_ID:price_PLACEHOLDER}
stripe.webhookSecret=${STRIPE_WEBHOOK_SECRET:whsec_PLACEHOLDER}

# ==============================================================================
# FIREBASE CONFIGURATION
# ==============================================================================
firebase.enabled=${FIREBASE_ENABLED:false}
firebase.credentials.base64=${GOOGLE_CREDENTIALS_BASE64:}
firebase.storage.bucket=${FIREBASE_STORAGE_BUCKET:screenleads-e7e0b.firebasestorage.app}

# ==============================================================================
# JWT SECURITY
# ==============================================================================
application.security.jwt.secret-key=${JWT_SECRET_KEY}
application.security.jwt.expiration=${JWT_EXPIRATION:86400000}

# ==============================================================================
# LOGGING
# ==============================================================================
logging.level.ROOT=${LOGGING_LEVEL_ROOT:INFO}
logging.level.com.screenleads=${LOGGING_LEVEL_APP:INFO}
logging.level.org.springframework.security=${LOGGING_LEVEL_SECURITY:INFO}
logging.level.org.springframework.web=${LOGGING_LEVEL_WEB:INFO}

# ==============================================================================
# ACTUATOR & MONITORING
# ==============================================================================
management.endpoints.enabled-by-default=false
management.endpoint.health.enabled=true
management.endpoint.info.enabled=true
management.endpoint.metrics.enabled=${ACTUATOR_METRICS_ENABLED:false}
management.endpoints.web.exposure.include=${MANAGEMENT_ENDPOINTS_WEB_EXPOSURE:health,info}
management.endpoint.health.show-details=when-authorized

# ==============================================================================
# SWAGGER / OPENAPI
# ==============================================================================
springdoc.api-docs.enabled=${SWAGGER_ENABLED:true}
springdoc.swagger-ui.enabled=${SWAGGER_ENABLED:true}
springdoc.swagger-ui.path=/swagger-ui

# ==============================================================================
# WEB RESOURCES
# ==============================================================================
spring.web.resources.add-mappings=false

# ==============================================================================
# VAULT CONFIGURATION (Optional)
# ==============================================================================
vault.enabled=${VAULT_ENABLED:false}
vault.address=${VAULT_ADDR:http://localhost:8200}
vault.token=${VAULT_TOKEN:}
vault.secret-path=${VAULT_SECRET_PATH:secret/screenleads}